<link href="https://fonts.googleapis.com/css?family=Open+Sans:400,600" rel="stylesheet">
<style type="text/css">
  body, html {
    height: 100%;
    margin: 0;
  }

  body {
    display: flex;
    justify-content: center;
    align-items: center;
  }

  #wrapper {
    box-sizing: border-box;
    display: flex;
    justify-content: center;
    align-items: center;
    background: #fff;
  }

  #wrapper a { text-decoration: none; }

  #ad {
    box-sizing: border-box;
    /*background: url("http://www8.hp.com/us/en/images/LT_Pro_Composite_0000_1__281_29_tcm245_2192431_tcm245_2193389_tcm245-2192431.png");*/
    background-size: cover;
    background-position: center center;
    display: flex;
    align-items: center;
    justify-content: center;
    flex-direction: row;
    text-align: center;
    border: 1px solid #b1b1b1;
    font-family: 'Open Sans', sans-serif;
    font-weight: 400;
    padding: 0 20px;
  }

  #ad h2 {
    line-height: 1.2em;
    font-size: 14px;
    color: #000;
    margin: 0 10px;
  }

  #logo {
    position: absolute;
    top: 8px;
    left: 6px;
    width: 140px;
  }

  #product {
    width: 104px;
    /*top: 1px;*/
    /*position: absolute;*/
    /*left: 11px;*/
  }

  #action-box {
    display: flex;
    align-items: flex-start;
    justify-content: center;
    flex-direction: column;
    box-sizing: border-box;
    background: rgba(255,255,255,0.9);
    text-align: left;
    width: 100%;
    padding: 16px;
  }

  #button-wrapper {

  }

  #button {
    background: #3379C2;
    display: inline-block;
    padding: 8px 16px;
    /*border-radius: 20px;*/
    font-size: 14px;
    color: white;
    cursor: pointer;
    border-radius: 6px;
    min-width: 80px;
  }

  #value {
    position: absolute;
    right: 0px;
    bottom: 0px;
    font-size: 9px;
    color: white;
    text-align: right;
    background: black;
    padding: 0 2px;
  }

  #price { font-weight: bold; color: #CA0813; font-size: 22px; vertical-align: text-top; margin-right: 15px; }

</style>
</head>
<body>
<div id="wrapper">
  <div id="buffer">
    <div id="ad">
      <img src="https://officedepot.scene7.com/is/image/officedepot/2774708_p_hp_17_by0053od_laptop?id=glJrX3&fmt=jpg&fit=constrain,1&wid=762&hei=648&op_sharpen=1&qlt=95" id="product">
        <h2 id="headline">HP 17-by0053od Laptop, 17.3&quot; Screen, 8th Gen Intel&reg; Core&trade; i3, 4GB Memory/16GB Intel&reg; Optane&trade; Memory, 1TB Hard Drive, Windows&reg; 10 Home</h2>
      <div id="price">$459.99</div>
      <div id="button">Add to Cart</div>
      <div id="value"></div>
    </div>
  </div>
</div>
<script>

  //resize function fires on load and every window resize
  (function resizeAd(event) {
   
    // get wrapper width (again)
    var wrapperWidth = document.getElementById("wrapper").parentNode.offsetWidth;
    var wrapperHeight = document.getElementById("wrapper").parentNode.offsetHeight;

    // make ad match iframe size
    document.getElementById("ad").style.width = wrapperWidth + "px";
    document.getElementById("ad").style.height = wrapperHeight + "px";
    
    // set ad width vars
    var adWidth = document.getElementById("ad").offsetWidth;
    var adHeight = document.getElementById("ad").offsetHeight;
    
    // figure out multiplier value for exact window size
    var scale = Math.min(wrapperWidth, wrapperHeight) / Math.min(adWidth, adHeight);
    
    // set text var
    var txt = wrapperWidth + " x " + wrapperHeight;
    
    // change layout at 600px breakpoint
    if (wrapperWidth > 600 || wrapperHeight < 60) {

    }

    // styles for tiny mobile sizes
    if (wrapperHeight < 60) {

    }

    // styles for 728x90
    if (wrapperWidth == 728) {
      // document.getElementById("ad").style.backgroundPosition = "-180px center";
      // document.getElementById("headline").style.fontSize = "20px";
      // document.getElementById("button").style.padding = "4px 16px";
      // document.getElementById("action-box").style.width = "auto";
    }

    // styles for 970x60
    if (wrapperWidth == 970 && wrapperHeight < 70 ) {

    }

    // scale ad according to multiplier
    // document.getElementById("ad").style.transform = "scale(" + scale + ")";
    
    // inject text
    document.getElementById("value").innerHTML = txt;
    
    console.log(adWidth + ":" + adHeight);

  }()); 

  // FUNCTION TO EMBED
  var ATC = (function(){
          app = {
              opts : {
                  jsessionid : '',
                  addToCartClass : 'add-to-cart',
                  endPoint: 'https://www.officedepot.com/cart/addSkuByButtonSecure.do',
                  xhr : null,
              },
              pub : {
                  init : function(){
                    app.opts.jsessionid = window.jSessionID + ':' + window.cloneID;
                  },
                  add : function(sku, qty){
                      var postUrl = app.opts.endPoint + ';jsessionid=' + app.opts.jsessionid + '?ajaxATCRequest=true&sourcePage=&cmd_addCart.button.INDEX[0]=Add%20to%20Cart&entryFormList[0].sku=' + sku + '&entryFormList[0].qty='+qty;
                      app.priv.ajax(postUrl, 'POST', function(rs){
                          console.log('Result', app.opts.xhr);
                          //window.open('https://www.officedepot.com/cart/shoppingCart.do');
                          parent.window.location.href = "https://www.officedepot.com/cart/shoppingCart.do";
                      },'text');
                  }
              },
              priv:{
                  onError : function(){},
                  ajax: function (url, _getPost, callback, datatype) {
                      var getPost = (typeof _getPost !== null) ? _getPost : 'GET';
                      var dt = (typeof datatype !== null) ? datatype : 'json';
                      app.opts.xhr = new XMLHttpRequest();
                      app.opts.xhr.onLoad = function (e) {
                          app.opts.xhr = e.target;
                          if (app.opts.xhr.responseType === 'json') {
                              results.innerHTML = app.opts.xhr.response.message;
                          } else {
                              results.innerHTML = JSON.parse(app.opts.xhr.responseText).message;
                          }
                      };
   
                      app.opts.xhr.onerror = app.priv.onError;
                      app.opts.xhr.onreadystatechange = function () {
                          var DONE = 4; // readyState 4 means the request is done.
                          var OK = 200; // status 200 is a successful return.
                          if (app.opts.xhr.readyState === DONE) {
                              if (app.opts.xhr.status === OK) {
                                  callback.call(app.opts.xhr.response);
                              }
                          } else {
                              //app.priv.onError(opts.xhr);
                          }
                      };
                      //console.log('dt',dt);
                      app.opts.xhr.open(_getPost, url);
                      app.opts.xhr.responseType = dt;
                      app.opts.xhr.send();
                  },
              }
          }
   
          return app.pub;
      })();
  ATC.init();

  function runCart(event) {
    ATC.add('2774708', 1);
    // parent.window.location.href = "https://www.officedepot.com/cart/shoppingCart.do";
  }

  document.getElementById("button").addEventListener('click', runCart);
</script>